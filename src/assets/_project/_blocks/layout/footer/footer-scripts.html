<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script> -->
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

<!-- Butterfly Lightbox -->
<script src="/assets/v3/lib/ext/butterfly/jquery.resize-events.js"></script>
<script src="/assets/v3/lib/ext/butterfly/jquery.history.js"></script>
<script src="/assets/v3/lib/ext/butterfly/jquery.butterfly.js"></script>

<!-- Require main javascript -->
<script src="/assets/v3/js/qg-main.js"></script>

<script type="text/javascript">

    //====================================================================================================
    // load the cidm-loader that will in turn pull in the depenencies

    requirejs(['/cidm-login-widget/js/cidm-loader.js'], function() {

        //____________________________________________________________________________________________________
        // now use the cidm-neo widget and optional cidm-utils to show the profile

        requirejs(['cidm-neo', 'cidm-utils'], function(neo, utils) {

            //____________________________________________________________________________________________________
            // please note that $ jquery is loaded as part of the cidm-loader dependencies

            $(document).ready(function() {

                //____________________________________________________________________________________________________
                // this is the way that you would initialize the QGCIDM Wrapped Widget

                $.qgcidm.initialise({
                    home: 'http://localhost:3000',
                    domain: 'dev.qld-gov-dev.auth0.com',
                    clientID: 'ALlrgybFMJyjI7fwgj1DkDnJPd5qb2gG',
                    webtaskHome: 'webtask.qld-gov-dev.auth0.com/api/run/dev',
                    level: 'Level_1',
                    wrapped: true,
                    returnTo: window.location.href,
                    myAccountURL: 'https://www.myaccount.test-services.qld.gov.au'
                });

                //____________________________________________________________________________________________________
                // this step tags the avatar div tag with the login/logout and name/icon widget

                $('#qg-login-avatar').avatar();

                $(document).on('shown.qgcidm.loginMenu', function(){
                    $(document).find('.collapse.in').collapse('hide');
                });

                $(document).on('show.bs.collapse', function() {
                    $.qgcidm.toggleLoginMenu({forceHide: true});
                });

                var setLoginMenuPosition = function() {
                    if (window.innerWidth >= 992) {
                        $('#qg-search-form').after($('#qg-login-avatar'));
                    } else {
                        $('#qg-login-avatar').appendTo($('#qg-avatar-placeholder'));
                    }
                };

                $(window).resize(function() {
                    setLoginMenuPosition();
                });

                $(window).scroll(function() {
                    if ($('#qg-login-menu > div:visible').css('position') === 'fixed') {
                        $.qgcidm.toggleLoginMenu({forceHide: true});
                    }
                });

                //====================================================================================================
                // this step enables the profile widget and renders the widget

                $.qgcidm.enable();
                setLoginMenuPosition();
            });
        });
    });
</script>